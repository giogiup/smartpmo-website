<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AI for PMO Professionals — Daily Insights | SmartPMO.ai</title>

  <!-- ── Primary SEO ── -->
  <meta name="description" content="SmartPMO.ai scans thousands of articles daily to surface AI news, tools and techniques that apply directly to PMO work. Free weekly newsletter for project management professionals.">
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="author" content="SmartPMO.ai">
  <link rel="canonical" href="https://smartpmo.ai/">

  <!-- ── Open Graph ── -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="SmartPMO.ai">
  <meta property="og:url" content="https://smartpmo.ai/">
  <meta property="og:locale" content="en_ZA">
  <meta property="og:title" content="AI for PMO Professionals — Daily Insights | SmartPMO.ai">
  <meta property="og:description" content="SmartPMO.ai scans thousands of articles daily to surface AI news, tools and techniques that apply directly to PMO work. Free weekly newsletter.">
  <!-- og:image: create a 1200x630 PNG and place at /og-image.png to enable social previews -->
  <meta property="og:image:alt" content="SmartPMO.ai — AI Insights for PMO Professionals">

  <!-- ── Twitter / X Card ── -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@SmartPMOai">
  <meta name="twitter:creator" content="@SmartPMOai">
  <meta name="twitter:title" content="AI for PMO Professionals — Daily Insights | SmartPMO.ai">
  <meta name="twitter:description" content="SmartPMO.ai scans thousands of articles daily to surface AI insights that apply directly to PMO work.">
  <meta name="twitter:image:alt" content="SmartPMO.ai — AI Insights for PMO Professionals">

  <!-- ── Mobile / PWA ── -->
  <meta name="theme-color" content="#06B6D4">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="SmartPMO.ai">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- ── Favicon chain ── -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="apple-touch-icon" href="/favicon.svg">
  <link rel="manifest" href="/site.webmanifest">

  <!-- ── JSON-LD: Organization ── -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "@id": "https://smartpmo.ai/#organization",
    "name": "SmartPMO.ai",
    "url": "https://smartpmo.ai",
    "logo": {
      "@type": "ImageObject",
      "url": "https://smartpmo.ai/logo.png",
      "width": 400,
      "height": 400
    },
    "description": "SmartPMO.ai is an AI-powered content discovery platform that finds and curates AI-applicable insights for PMO professionals from thousands of daily articles.",
    "foundingDate": "2025",
    "knowsAbout": ["Project Management Office", "Artificial Intelligence", "PMO governance", "AI tools for project management", "Agile delivery"],
    "sameAs": [
      "https://www.linkedin.com/company/smartpmo-ai",
      "https://twitter.com/SmartPMOai"
    ]
  }
  </script>

  <!-- ── JSON-LD: WebSite ── -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "@id": "https://smartpmo.ai/#website",
    "name": "SmartPMO.ai",
    "url": "https://smartpmo.ai",
    "description": "Daily AI-curated insights for PMO professionals. Free weekly newsletter.",
    "publisher": {
      "@id": "https://smartpmo.ai/#organization"
    },
    "inLanguage": "en",
    "copyrightYear": "2025"
  }
  </script>

  <!-- ── JSON-LD: CollectionPage ── -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "@id": "https://smartpmo.ai/#collection",
    "name": "AI Insights for PMO Professionals",
    "description": "Curated daily collection of AI news, tools, and techniques applicable to PMO and project management work.",
    "url": "https://smartpmo.ai",
    "isPartOf": {
      "@id": "https://smartpmo.ai/#website"
    },
    "publisher": {
      "@id": "https://smartpmo.ai/#organization"
    },
    "inLanguage": "en",
    "about": {
      "@type": "Thing",
      "name": "Artificial Intelligence in Project Management"
    }
  }
  </script>

  <!-- Preload hero image for faster LCP -->
  <link rel="preload" as="image" href="hero-barista-small.jpg" imagesrcset="hero-barista-small.jpg 600w, hero-barista.jpg 1200w">
  
  <!-- Fonts: Display + Serif for editorial feel -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&family=Spectral:wght@400;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles-v2.css?v=6ea542f">
  <link rel="stylesheet" href="hero.css?v=6ea542f">
  <link rel="stylesheet" href="header-styles.css?v=6ea542f">

  <link rel="stylesheet" href="section-votes.css?v=6ea542f">
  <link rel="stylesheet" href="mobile-fixes.css?v=6ea542f">
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <style>
    /* Critical CSS for above-the-fold (inline for instant first paint) */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0a0e1a;
      color: #e0e7ff;
      line-height: 1.6;
      overflow-x: hidden;
    }    
    
    /* Mobile optimizations */
    @media (max-width: 768px) {
      body {
        overflow-x: hidden !important;
        max-width: 100vw !important;
      }
      .emailoctopus-form-wrapper > * {
        max-width: calc(100vw - 40px) !important;
      }
      
      /* Better tap targets */
      .nav a {
        padding: 0.6rem 0.4rem;
        min-height: 48px;
        display: inline-flex;
        align-items: center;
      }
      .btn-primary {
        min-height: 48px;
      }
    }
    
    /* Accessibility: Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>
<body>

<!-- ── Maintenance Banner ── -->
<div id="maintenance-banner" style="
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 9999;
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: #1a1a1a;
  text-align: center;
  padding: 0.6rem 3rem 0.6rem 1rem;
  font-size: 0.875rem;
  font-weight: 600;
  font-family: 'Inter', sans-serif;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  box-sizing: border-box;
">
  🔧 We're making improvements — some features may be temporarily unavailable. Thanks for your patience.
  <button onclick="document.getElementById('maintenance-banner').style.display='none'" style="
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 1.25rem;
    cursor: pointer;
    color: #1a1a1a;
    line-height: 1;
    padding: 0.25rem;
  " aria-label="Dismiss">×</button>
</div>
<style>
  /* Banner offset: push fixed header below banner */
  .site-header { top: 38px !important; }
  body { padding-top: calc(70px + 38px) !important; }
  @media (max-width: 639px) {
    .site-header { top: 52px !important; }
    body { padding-top: calc(70px + 52px) !important; }
    #maintenance-banner { font-size: 0.8rem !important; padding: 0.75rem 3rem 0.75rem 0.75rem !important; }
  }
</style>

  <!-- Header Component (V4) -->
  <header class="site-header">
    <div class="site-header-content">

      <!-- Logo + Brand -->
      <a href="/" class="site-header-brand">
        <svg class="site-header-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <rect x="4" y="6" width="8" height="2" rx="1" fill="#4C78FF"/>
          <rect x="4" y="10" width="12" height="2" rx="1" fill="#00D4FF"/>
          <rect x="4" y="14" width="6" height="2" rx="1" fill="#00F5FF"/>
          <circle cx="3" cy="7" r="1.5" fill="#825AFF"/>
          <circle cx="3" cy="11" r="1.5" fill="#00D4FF"/>
          <circle cx="3" cy="15" r="1.5" fill="#00F5FF"/>
          <g transform="translate(13,7) scale(0.7)">
            <path d="M0 -3 Q1 -1 3 0 Q1 1 0 3 Q-1 1 -3 0 Q-1 -1 0 -3 Z" fill="#00F5FF"/>
            <path d="M0 -2 Q0.7 -0.7 2 0 Q0.7 0.7 0 2 Q-0.7 0.7 -2 0 Q-0.7 -0.7 0 -2 Z" fill="#ffffff" opacity="0.8"/>
            <path d="M0 -1.2 Q0.4 -0.4 1.2 0 Q0.4 0.4 0 1.2 Q-0.4 0.4 -1.2 0 Q-0.4 -0.4 0 -1.2 Z" fill="#4C78FF"/>
          </g>
          <g transform="translate(17,11) scale(1.3)">
            <path d="M0 -3 Q1 -1 3 0 Q1 1 0 3 Q-1 1 -3 0 Q-1 -1 0 -3 Z" fill="#00F5FF"/>
            <path d="M0 -2 Q0.7 -0.7 2 0 Q0.7 0.7 0 2 Q-0.7 0.7 -2 0 Q-0.7 -0.7 0 -2 Z" fill="#ffffff" opacity="0.8"/>
            <path d="M0 -1.2 Q0.4 -0.4 1.2 0 Q0.4 0.4 0 1.2 Q-0.4 0.4 -1.2 0 Q-0.4 -0.4 0 -1.2 Z" fill="#825AFF"/>
          </g>
          <g transform="translate(11,15) scale(1.0)">
            <path d="M0 -3 Q1 -1 3 0 Q1 1 0 3 Q-1 1 -3 0 Q-1 -1 0 -3 Z" fill="#ffffff"/>
            <path d="M0 -2 Q0.7 -0.7 2 0 Q0.7 0.7 0 2 Q-0.7 0.7 -2 0 Q-0.7 -0.7 0 -2 Z" fill="#00F5FF" opacity="0.9"/>
            <path d="M0 -1.2 Q0.4 -0.4 1.2 0 Q0.4 0.4 0 1.2 Q-0.4 0.4 -1.2 0 Q-0.4 -0.4 0 -1.2 Z" fill="#4C78FF"/>
          </g>
        </svg>
        <span class="site-header-name">SmartPMO.ai</span>
      </a>

      <!-- Desktop Navigation -->
      <nav class="site-header-nav">
        <a href="#latest-intelligence" class="site-header-nav-link">Latest Intelligence</a>
        <a href="#strategic-insights" class="site-header-nav-link">Strategic Insights</a>
        <a href="#blog" class="site-header-nav-link">Blog</a>
        <a href="/assessment" class="site-header-nav-link">Assessment</a>
        <a href="/assessment" class="site-header-cta-button">
          <span>Take Assessment</span>
          <span>&rarr;</span>
        </a>
      </nav>

      <!-- Mobile Menu Toggle -->
      <button class="site-header-mobile-toggle" onclick="HeaderMenu.toggle()" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

    </div>
  </header>

  <!-- Mobile Menu Overlay -->
  <div class="site-header-mobile-menu" id="siteHeaderMobileMenu">
    <nav class="site-header-mobile-nav">
      <a href="#latest-intelligence" class="site-header-mobile-nav-link" onclick="HeaderMenu.close()">Latest Intelligence</a>
      <a href="#strategic-insights" class="site-header-mobile-nav-link" onclick="HeaderMenu.close()">Strategic Insights</a>
      <a href="#blog" class="site-header-mobile-nav-link" onclick="HeaderMenu.close()">Blog</a>
      <a href="/assessment" class="site-header-mobile-nav-link" onclick="HeaderMenu.close()">Assessment</a>
      <a href="/assessment" class="site-header-mobile-cta" onclick="HeaderMenu.close()">
        <span>Take Assessment</span>
        <span>&rarr;</span>
      </a>
    </nav>
  </div>

  <!-- HERO SECTION - LAYOUT B (Stacked Narrative) -->
  <section class="hero-section">

    <!-- Band 1: Headline -->
    <div class="hero-band-1">
      <h1 class="hero-headline">How Smart is Your PMO at AI?</h1>
      <p class="hero-subheadline">Every day, 8.5 million articles are published online.<br>We find the ones that matter for PMO practitioners.</p>
    </div>

    <!-- Band 2: Copy + Quadrant Grid -->
    <div class="hero-band-2">

      <!-- Left: Value prop + Assessment CTA -->
      <div class="hero-band-2-copy">
        <p class="hero-body">
          SmartPMO.ai scans thousands of articles daily and uses AI to surface the insights at the intersection of artificial intelligence and project management. No noise. No irrelevant content. Just the articles, tools, and techniques that PMO practitioners can actually use.
        </p>
        <p class="hero-assessment-prompt">
          Take the 15-question assessment to find your PMO's AI quadrant &mdash; and get a personalised action plan to move forward.
        </p>
        <a href="/assessment" class="hero-btn-primary">
          <span>Take the Assessment</span>
          <span>&rarr;</span>
        </a>
      </div>

      <!-- Right: Quadrant Grid -->
      <div class="hero-visual-wrapper">

        <div class="hero-quadrant-grid">

          <!-- Y-Axis (Vertical - Value) -->
          <div class="hero-y-axis">
            <span class="hero-axis-low">LOW</span>
            <svg width="60" height="2">
              <polygon points="0,1 60,2 60,0" fill="url(#hero-g2)"/>
              <defs>
                <linearGradient id="hero-g2">
                  <stop offset="0%" stop-color="rgba(107,114,128,0.3)"/>
                  <stop offset="100%" stop-color="rgba(6,182,212,0.8)"/>
                </linearGradient>
              </defs>
            </svg>
            <span class="hero-axis-label">VALUE</span>
            <svg width="60" height="2">
              <polygon points="0,0 60,1 0,2" fill="url(#hero-g1)"/>
              <defs>
                <linearGradient id="hero-g1">
                  <stop offset="0%" stop-color="rgba(6,182,212,0.8)"/>
                  <stop offset="100%" stop-color="rgba(107,114,128,0.3)"/>
                </linearGradient>
              </defs>
            </svg>
            <span class="hero-axis-high">HIGH</span>
          </div>

          <!-- Q1: Prompt Whisperers (Top-Left) -->
          <div class="hero-quad hero-q1" data-quad="q1"
               onmouseenter="HeroAssessment.showTooltip('q1')"
               onmouseleave="HeroAssessment.hideTooltip('q1')"
               onclick="HeroAssessment.handleQuadrantClick('q1')">
            <div class="hero-tap-indicator">&#8505;&#65039;</div>
            <div class="hero-hover-hint">Hover for details</div>
            <div class="hero-tooltip"><strong style="display:block; margin-bottom:0.5rem; font-size:0.95rem; color:#06B6D4;">Prompt Whisperers</strong>You haven't rolled AI out widely, but the use cases you've chosen are delivering measurable results. You're strategic and selective &mdash; picking high-value applications and proving ROI before scaling. The risk now is staying small when you've already proven the model works.</div>
            <svg class="hero-icon" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="20" cy="20" r="8"/>
              <path d="M12 36 Q12 28, 20 28 Q28 28, 28 36"/>
              <circle cx="36" cy="18" r="6" fill="none"/>
              <path d="M36 24 L34 28 L32 26"/>
              <circle cx="46" cy="26" r="6" fill="none"/>
              <path d="M46 32 L44 36 L42 34"/>
              <circle cx="56" cy="34" r="6" fill="none"/>
              <path d="M56 40 L54 44 L52 42"/>
            </svg>
            <div class="hero-qname">Prompt<br>Whisperers</div>
            <div class="hero-qpct">28%</div>
          </div>

          <!-- Q2: Zen PMO (Top-Right) -->
          <div class="hero-quad hero-q2" data-quad="q2"
               onmouseenter="HeroAssessment.showTooltip('q2')"
               onmouseleave="HeroAssessment.hideTooltip('q2')"
               onclick="HeroAssessment.handleQuadrantClick('q2')">
            <div class="hero-tap-indicator">&#8505;&#65039;</div>
            <div class="hero-hover-hint">Hover for details</div>
            <div class="hero-tooltip"><strong style="display:block; margin-bottom:0.5rem; font-size:0.95rem; color:#8B5CF6;">Zen PMO</strong>AI is woven into how your PMO plans, executes, monitors, and reports. You have governance, metrics, and leadership sees the PMO as a strategic partner. Only 6% of PMOs reach this level. Your challenge is staying ahead as the landscape shifts monthly.</div>
            <svg class="hero-icon" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="32" cy="32" r="20"/>
              <path d="M32 12 Q32 22, 32 32 Q32 42, 32 52" stroke-width="2.5"/>
              <path d="M32 12 Q42 22, 32 32 Q22 42, 32 52" fill="currentColor" opacity="0.2"/>
              <circle cx="32" cy="22" r="3" fill="currentColor"/>
              <circle cx="32" cy="42" r="3" stroke="currentColor" fill="none"/>
            </svg>
            <div class="hero-qname">Zen PMO</div>
            <div class="hero-qpct">6%</div>
          </div>

          <!-- Q3: Spreadsheet Nation (Bottom-Left) -->
          <div class="hero-quad hero-q3" data-quad="q3"
               onmouseenter="HeroAssessment.showTooltip('q3')"
               onmouseleave="HeroAssessment.hideTooltip('q3')"
               onclick="HeroAssessment.handleQuadrantClick('q3')">
            <div class="hero-tap-indicator">&#8505;&#65039;</div>
            <div class="hero-hover-hint">Hover for details</div>
            <div class="hero-tooltip"><strong style="display:block; margin-bottom:0.5rem; font-size:0.95rem; color:#9CA3AF;">Spreadsheet Nation</strong>Your PMO runs on manual processes, spreadsheets, and established routines. AI hasn't entered the picture in any meaningful way yet. You're not behind &mdash; most PMOs were here 18 months ago. But the gap between AI-enabled PMOs and traditional ones is widening fast.</div>
            <svg class="hero-icon" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="12" y="12" width="40" height="40" rx="3"/>
              <line x1="26" y1="12" x2="26" y2="52"/>
              <line x1="40" y1="12" x2="40" y2="52"/>
              <line x1="12" y1="24" x2="52" y2="24"/>
              <line x1="12" y1="36" x2="52" y2="36"/>
              <rect x="15" y="38" width="7" height="12" fill="currentColor" opacity="0.6"/>
              <rect x="29" y="30" width="7" height="20" fill="currentColor" opacity="0.6"/>
              <rect x="43" y="26" width="7" height="24" fill="currentColor" opacity="0.6"/>
            </svg>
            <div class="hero-qname">Spreadsheet<br>Nation</div>
            <div class="hero-qpct">10%</div>
          </div>

          <!-- Q4: ChatGPT Fan Club (Bottom-Right) -->
          <div class="hero-quad hero-q4" data-quad="q4"
               onmouseenter="HeroAssessment.showTooltip('q4')"
               onmouseleave="HeroAssessment.hideTooltip('q4')"
               onclick="HeroAssessment.handleQuadrantClick('q4')">
            <div class="hero-tap-indicator">&#8505;&#65039;</div>
            <div class="hero-hover-hint">Hover for details</div>
            <div class="hero-tooltip"><strong style="display:block; margin-bottom:0.5rem; font-size:0.95rem; color:#F59E0B;">ChatGPT Fan Club</strong>Your team has jumped into AI &mdash; ChatGPT, Copilot, transcription tools &mdash; but it's scattered experimentation. Individual productivity improves, but leadership can't see the impact. You're in pilot purgatory: lots of activity, no proven business value. 52% of PMOs are stuck here.</div>
            <svg class="hero-icon" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="18" cy="24" r="6"/>
              <path d="M12 38 Q12 32, 18 32 Q24 32, 24 38"/>
              <circle cx="32" cy="22" r="7"/>
              <path d="M25 38 Q25 30, 32 30 Q39 30, 39 38"/>
              <circle cx="46" cy="24" r="6"/>
              <path d="M40 38 Q40 32, 46 32 Q52 32, 52 38"/>
              <rect x="26" y="44" width="22" height="14" rx="3"/>
              <path d="M32 58 L32 60 L34 58"/>
              <circle cx="32" cy="51" r="1.2" fill="currentColor"/>
              <circle cx="38" cy="51" r="1.2" fill="currentColor"/>
              <circle cx="44" cy="51" r="1.2" fill="currentColor"/>
            </svg>
            <div class="hero-qname">ChatGPT<br>Fan Club</div>
            <div class="hero-qpct">52%</div>
          </div>

          <!-- X-Axis (Horizontal - AI Adoption) -->
          <div class="hero-x-axis">
            <span class="hero-axis-low">LOW</span>
            <svg width="70" height="2">
              <polygon points="0,1 70,2 70,0" fill="url(#hero-g3)"/>
              <defs>
                <linearGradient id="hero-g3">
                  <stop offset="0%" stop-color="rgba(107,114,128,0.3)"/>
                  <stop offset="100%" stop-color="rgba(6,182,212,0.8)"/>
                </linearGradient>
              </defs>
            </svg>
            <span class="hero-axis-label">AI ADOPTION</span>
            <svg width="70" height="2">
              <polygon points="0,0 70,1 0,2" fill="url(#hero-g4)"/>
              <defs>
                <linearGradient id="hero-g4">
                  <stop offset="0%" stop-color="rgba(6,182,212,0.8)"/>
                  <stop offset="100%" stop-color="rgba(107,114,128,0.3)"/>
                </linearGradient>
              </defs>
            </svg>
            <span class="hero-axis-high">HIGH</span>
          </div>

        </div>

      </div>

    </div>

    <!-- Band 3: Newsletter + Quarterly Report -->
    <div class="hero-band-3">

      <!-- Left: Newsletter -->
      <div class="hero-band-3-newsletter">
        <div class="hero-band-3-icon">&#128236;</div>
        <h3 class="hero-band-3-title">Weekly Top 20</h3>
        <p class="hero-band-3-desc">The best AI-for-PMO articles of the week, delivered free every Friday.</p>
        <div class="hero-newsletter-form">
          <!-- EmailOctopus Embedded Form -->
          <script async src="https://eocampaign1.com/form/73a90686-a1f9-11f0-9b87-6727ec6b3f72.js" data-form="73a90686-a1f9-11f0-9b87-6727ec6b3f72"></script>
        </div>
      </div>

      <!-- Right: Quarterly Report -->
      <div class="hero-band-3-report">
        <div class="hero-band-3-icon">&#128202;</div>
        <h3 class="hero-band-3-title">Quarterly Report</h3>
        <p class="hero-band-3-desc"><em>AI Maturity in PMOs: The Global Reality Check</em> &mdash; our deep-dive into how PMOs worldwide are adopting AI.</p>
        <div class="hero-report-status">Coming Soon</div>
        <button class="hero-btn-secondary" onclick="document.getElementById('hero-report-email').focus()">
          <span>Notify Me</span>
          <span>&rarr;</span>
        </button>
        <input type="email" id="hero-report-email" class="hero-report-email-input" placeholder="your@email.com" aria-label="Email for quarterly report notification">
      </div>

    </div>

  </section>

  <!-- Section 1: Latest Intelligence (Auto) -->
  <section class="insights-section" id="latest-intelligence">
    <h2 class="section-title section-title--auto">
      <i data-lucide="zap"></i> Latest Intelligence
      <span class="section-subtitle">AI-Discovered PMO Insights</span>
    </h2>

    <!-- Skeleton Loaders (shown during fetch) -->
    <div id="skeleton-loaders" class="insights-grid" aria-hidden="true">
      <div class="skeleton-card">
        <div class="skeleton-title"></div>
        <div class="skeleton-tldr">
          <div class="skeleton-line"></div>
          <div class="skeleton-line"></div>
          <div class="skeleton-line short"></div>
        </div>
        <div class="skeleton-badges">
          <div class="skeleton-badge"></div>
          <div class="skeleton-badge"></div>
        </div>
      </div>
      <div class="skeleton-card">
        <div class="skeleton-title"></div>
        <div class="skeleton-tldr">
          <div class="skeleton-line"></div>
          <div class="skeleton-line"></div>
          <div class="skeleton-line short"></div>
        </div>
        <div class="skeleton-badges">
          <div class="skeleton-badge"></div>
          <div class="skeleton-badge"></div>
        </div>
      </div>
      <div class="skeleton-card">
        <div class="skeleton-title"></div>
        <div class="skeleton-tldr">
          <div class="skeleton-line"></div>
          <div class="skeleton-line"></div>
          <div class="skeleton-line short"></div>
        </div>
        <div class="skeleton-badges">
          <div class="skeleton-badge"></div>
          <div class="skeleton-badge"></div>
        </div>
      </div>
    </div>

    <!-- Real cards (hidden until loaded) -->
    <div class="insights-grid" id="auto-articles-grid" style="display:none;"></div>
  </section>

  <!-- Section 2: Strategic Insights (Curated) -->
  <section class="insights-section" id="strategic-insights">
    <h2 class="section-title section-title--curated">
      <i data-lucide="star"></i> Strategic Insights
      <span class="section-subtitle">Curated by PMO Experts</span>
    </h2>
    <div class="insights-grid" id="curated-articles-grid"></div>
  </section>

  <!-- Footer -->
  <footer>
    <p>© 2025 SmartPMO.ai — AI-powered insights for PMO professionals</p>
  </footer>

  <!-- SVG Badge Definitions -->
  <svg style="position:absolute;width:0;height:0">
    <defs>
      <!-- Tier Hexagon -->
      <symbol id="icon-tier" viewBox="0 0 24 24">
        <path d="M12 2 L22 8 L22 16 L12 22 L2 16 L2 8 Z" fill="none" stroke="currentColor" stroke-width="2"/>
      </symbol>
      <!-- Score Diamond -->
      <symbol id="icon-score" viewBox="0 0 24 24">
        <path d="M12 2 L22 12 L12 22 L2 12 Z" fill="currentColor"/>
      </symbol>
      <!-- Price Coin -->
      <symbol id="icon-price" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
        <path d="M12 6 L12 18 M8 9 L16 9 M8 15 L16 15" stroke="currentColor" stroke-width="2"/>
      </symbol>
      <!-- Time Clock -->
      <symbol id="icon-time" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
        <path d="M12 6 L12 12 L16 14" stroke="currentColor" stroke-width="2" fill="none"/>
      </symbol>
      
      <!-- Score Gradients -->
      <linearGradient id="score-low" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#FF4444"/>
        <stop offset="100%" stop-color="#FF8800"/>
      </linearGradient>
      <linearGradient id="score-med" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#FFD700"/>
        <stop offset="100%" stop-color="#FFA500"/>
      </linearGradient>
      <linearGradient id="score-high" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#4C78FF"/>
        <stop offset="100%" stop-color="#00E6E6"/>
      </linearGradient>
      <linearGradient id="score-top" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#00F5FF"/>
        <stop offset="100%" stop-color="#00FFB3"/>
      </linearGradient>
    </defs>
  </svg>

  <script>
    // PMO Category configuration (3-tier system)
    const PMO_CATEGORY_CONFIG = {
      'PMO_RELATED': {
        icon: 'check-circle',
        label: 'PMO RELATED',
        tooltip: 'Content directly applicable to PMO work',
        class: 'pmo-related'
      },
      'PMO_POTENTIAL': {
        icon: 'lightbulb',
        label: 'PMO POTENTIAL',
        tooltip: 'AI content that could be applied to PMO with creativity',
        class: 'pmo-potential'
      },
      'AI_GENERAL': {
        icon: 'info',
        label: 'AI GENERAL',
        tooltip: 'Significant AI developments without clear PMO application',
        class: 'ai-general'
      }
    };

    // Legacy PMO Relevance configuration (backward compatibility)
    const PMO_RELEVANCE_CONFIG = {
      'Direct': {
        icon: 'check-circle',
        label: 'PMO RELATED',
        tooltip: 'Explicitly designed for PMO use',
        class: 'pmo-related'
      },
      'Inferred': {
        icon: 'lightbulb',
        label: 'PMO POTENTIAL',
        tooltip: 'Tool applicable to PMO workflows',
        class: 'pmo-potential'
      },
      'Potential': {
        icon: 'lightbulb',
        label: 'PMO POTENTIAL',
        tooltip: 'Potential PMO applications',
        class: 'pmo-potential'
      }
    };

    /**
     * Get badge configuration from pmo_category or fall back to pmo_relevance
     */
    function getBadgeConfig(card) {
      // New 3-category system
      if (card.pmo_category) {
        return PMO_CATEGORY_CONFIG[card.pmo_category] || PMO_CATEGORY_CONFIG['AI_GENERAL'];
      }
      // Legacy pmo_relevance fallback
      if (card.pmo_relevance) {
        return PMO_RELEVANCE_CONFIG[card.pmo_relevance] || PMO_RELEVANCE_CONFIG['Potential'];
      }
      // Default
      return PMO_CATEGORY_CONFIG['AI_GENERAL'];
    }

    /**
     * Normalize card data to handle both old and new formats
     * OLD: tagline, pmoArea, 4-5 tldr bullets, 5 badges
     * NEW: pmo_relevance, pmo_focus, 3 tldr bullets, 2 badges
     */
    function normalizeCardData(card) {
      // If already in new format, return as-is
      if (card.pmo_relevance && card.badges.pmo_focus) {
        return card;
      }

      // Convert old format to new format
      return {
        ...card,
        // Default to 'Potential' if no pmo_relevance
        pmo_relevance: card.pmo_relevance || 'Potential',
        // Trim TLDR to 3 bullets
        tldr: (card.tldr || []).slice(0, 3),
        // Normalize badge structure
        badges: {
          read_time: card.badges?.readTime || card.badges?.read_time || 5,
          pmo_focus: card.badges?.pmoArea || card.badges?.pmo_focus || 'Strategy',
          value_type: card.badges?.value_type || 'Strategic Tool',
          // Keep legacy for dynamic badge
          implementation: card.badges?.implementation || 'Medium',
          price: card.badges?.price || 'Free'
        },
        // Limit keywords to 3
        keywords: (card.keywords || []).slice(0, 3)
      };
    }

    /**
     * Select which badge to show alongside Read Time
     * Priority: Quick Win > Paid > PMO Focus
     */
    function selectDynamicBadge(card) {
      // Priority 1: If "Quick Win", show value_type badge
      if (card.badges.value_type === 'Quick Win') {
        return {
          icon: 'zap',
          value: 'Quick Win',
          class: 'badge-quick-win'
        };
      }

      // Priority 2: If "Paid" or "Enterprise", show price badge
      if (card.badges.price === 'Paid' || card.badges.price === 'Enterprise') {
        return {
          icon: 'dollar-sign',
          value: card.badges.price,
          class: 'badge-price'
        };
      }

      // Default: Show PMO Focus badge
      return {
        icon: 'layout-dashboard',
        value: card.badges.pmo_focus,
        class: 'badge-pmo-focus'
      };
    }

    function renderCards(cards) {
      const grid = document.getElementById('auto-articles-grid');
      grid.innerHTML = cards.map(card => {
        // Normalize old data format to new format
        const normalizedCard = normalizeCardData(card);
        const badgeConfig = getBadgeConfig(normalizedCard);
        const dynamicBadge = selectDynamicBadge(normalizedCard);

        return `
        <article class="article-card" aria-labelledby="card-title-${normalizedCard.id}">
          <!-- Card Header -->
          <div class="card-header">
            <!-- Badge Row: category + read-time + dynamic badge (inline, not absolute) -->
            <div class="card-badge-row">
              <div class="pmo-relevance-badge ${badgeConfig.class}" title="${badgeConfig.tooltip}">
                <i data-lucide="${badgeConfig.icon}"></i>
                <span>${badgeConfig.label}</span>
              </div>
              <span class="badge badge-time">
                <i data-lucide="clock"></i> ${normalizedCard.badges.read_time} min
              </span>
              <span class="badge ${dynamicBadge.class}">
                <i data-lucide="${dynamicBadge.icon}"></i> ${dynamicBadge.value}
              </span>
            </div>

            <!-- Title: full width, no right padding -->
            <h3 id="card-title-${normalizedCard.id}" class="card-title">
              <a href="${normalizedCard.url}" target="_blank" rel="noopener">${normalizedCard.title}</a>
            </h3>
          </div>

          <!-- Card Body -->
          <div class="card-body">
            <!-- TLDR (3 bullets, all plain weight) -->
            <ul class="card-tldr" aria-label="Key takeaways">
              ${normalizedCard.tldr.map(point => `<li>${point}</li>`).join('')}
            </ul>
          </div>

          <!-- Unified Footer: left (votes + divider + date) | right (share icons) -->
          <div class="card-footer-a" data-article-id="${normalizedCard.id}">
            <div class="footer-left">
              <button class="vote-btn vote-btn--up" aria-label="Useful" aria-pressed="false">
                <span class="vote-icon">👍</span>
                <span class="vote-count vote-count--up">0</span>
              </button>
              <button class="vote-btn vote-btn--down" aria-label="Not useful" aria-pressed="false">
                <span class="vote-icon">👎</span>
                <span class="vote-count vote-count--down">0</span>
              </button>
              <div class="footer-divider"></div>
              ${normalizedCard.date ? `<span class="footer-date">${formatCardDate(normalizedCard.date)}</span>` : ''}
            </div>
            <div class="footer-right">
              <button onclick='shareToLinkedIn(${JSON.stringify({id: normalizedCard.id, title: normalizedCard.title, article_url: normalizedCard.url, ai_description: normalizedCard.tldr.join(' ')})})' class="shr-icon btn-linkedin" title="Share on LinkedIn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </button>
              <button onclick='shareToTwitter(${JSON.stringify({id: normalizedCard.id, title: normalizedCard.title, article_url: normalizedCard.url})})' class="shr-icon btn-twitter" title="Share on X">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </button>
              <button onclick='shareViaEmail(${JSON.stringify({id: normalizedCard.id, title: normalizedCard.title, article_url: normalizedCard.url, ai_description: normalizedCard.tldr.join(' ')})})' class="shr-icon btn-email" title="Share via Email">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
              </button>
              <button onclick='copyLink(${JSON.stringify({id: normalizedCard.id, article_url: normalizedCard.url})}, event)' class="shr-icon btn-copy" title="Copy Link">
                <svg class="icon-copy" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
              <button onclick='shareToWhatsApp(${JSON.stringify({id: normalizedCard.id, title: normalizedCard.title, article_url: normalizedCard.url, ai_description: normalizedCard.tldr.join(' ')})})' class="shr-icon btn-whatsapp" title="Share on WhatsApp">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                </svg>
              </button>
            </div>
          </div>
        </article>
      `;
      }).join('');

      lucide.createIcons();
    }

    // Fetch real data from API - Daily Cards (Latest Intelligence - enriched)
    async function loadDailyCards() {
      const skeletonEl = document.getElementById('skeleton-loaders');
      const cardsEl = document.getElementById('auto-articles-grid');

      try {
        const response = await fetch('./api/daily-cards.json?t=' + Date.now());
        if (!response.ok) throw new Error('Failed to load cards');
        const data = await response.json();

        // Hide skeletons, show real cards
        skeletonEl.style.display = 'none';
        cardsEl.style.display = 'grid';

        console.log(`Loaded ${data.count} enriched cards from ${data.date}`);
        renderCards(data.cards);

      } catch (error) {
        console.error('Error loading daily cards:', error);
        // Show error state
        skeletonEl.innerHTML = '<p class="error-state">Failed to load articles. Please refresh.</p>';
      }
    }

    // Fetch curated insights (Strategic Insights section)
    async function loadCuratedInsights() {
      try {
        const response = await fetch('./api/displayed-articles.json?t=' + Date.now());
        if (!response.ok) throw new Error('Failed to load curated insights');
        const data = await response.json();
        console.log(`Loaded ${data.strategicInsights?.length || 0} curated insights`);
        renderCuratedSection(data.strategicInsights || []);
      } catch (error) {
        console.error('Error loading curated insights:', error);
      }
    }

    // Load dual-section articles (Latest Intelligence + Strategic Insights)
    async function loadDisplayedArticles() {
      try {
        const response = await fetch('./api/displayed-articles.json?t=' + Date.now());
        if (!response.ok) throw new Error('Failed to load articles');
        const data = await response.json();

        console.log(`Loaded ${data.counts.auto} auto + ${data.counts.curated} curated articles`);

        renderAutoSection(data.latestIntelligence);
        renderCuratedSection(data.strategicInsights);
      } catch (error) {
        console.error('Error loading articles:', error);
        alert('Failed to load insights. Please refresh.');
      }
    }

    // Render Latest Intelligence section (auto)
    function renderAutoSection(articles) {
      const skeletonEl = document.getElementById('skeleton-loaders');
      const grid = document.getElementById('auto-articles-grid');

      // Hide skeleton loaders
      if (skeletonEl) {
        skeletonEl.style.display = 'none';
      }

      // Show grid
      grid.style.display = 'grid';

      if (articles.length === 0) {
        grid.innerHTML = '<p class="no-articles">No articles available yet. Check back soon!</p>';
        return;
      }

      grid.innerHTML = articles.map(article => createArticleCard(article, 'auto')).join('');
      lucide.createIcons();
    }

    // Render Strategic Insights section (curated)
    function renderCuratedSection(articles) {
      const grid = document.getElementById('curated-articles-grid');

      if (articles.length === 0) {
        grid.innerHTML = '<p class="no-articles">No curated articles yet.</p>';
        return;
      }

      grid.innerHTML = articles.map(article => createArticleCard(article, 'curated')).join('');
      lucide.createIcons();
    }

    // Create article card HTML
    function createArticleCard(article, type) {
      const formattedDate = formatDate(article.publishedDate);
      const cardClass = type === 'auto' ? 'insight-card insight-card--auto' : 'insight-card insight-card--curated';

      return `
        <div class="${cardClass}">
          <h3 class="card-title">
            <a href="${article.url}" target="_blank">${article.title}</a>
          </h3>
          <div class="card-summary">${article.summary || ''}</div>
          <div class="card-meta">
            <span class="article-source">${article.source || 'Source Unknown'}</span>
            <span class="article-date">${formattedDate}</span>
            ${article.score ? `<span class="article-score">Score: ${article.score}</span>` : ''}
          </div>

          <!-- Unified Footer: votes LEFT + divider + share RIGHT -->
          <div class="card-footer-a" data-article-id="${article.id}">
            <div class="footer-votes">
              <button class="vote-btn vote-btn--up" aria-label="Useful" aria-pressed="false">
                <span class="vote-icon">👍</span>
                <span class="vote-count vote-count--up">0</span>
              </button>
              <button class="vote-btn vote-btn--down" aria-label="Not useful" aria-pressed="false">
                <span class="vote-icon">👎</span>
                <span class="vote-count vote-count--down">0</span>
              </button>
            </div>
            <div class="footer-divider"></div>
            <div class="footer-share">
              <button onclick='shareToLinkedIn(${JSON.stringify({id: article.id, title: article.title, article_url: article.url, ai_description: article.summary})})' class="shr-icon btn-linkedin" title="Share on LinkedIn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </button>
              <button onclick='shareToTwitter(${JSON.stringify({id: article.id, title: article.title, article_url: article.url})})' class="shr-icon btn-twitter" title="Share on X">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </button>
              <button onclick='shareViaEmail(${JSON.stringify({id: article.id, title: article.title, article_url: article.url, ai_description: article.summary})})' class="shr-icon btn-email" title="Share via Email">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
              </button>
              <button onclick='copyLink(${JSON.stringify({id: article.id, article_url: article.url})}, event)' class="shr-icon btn-copy" title="Copy Link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
              <button onclick='shareToWhatsApp(${JSON.stringify({id: article.id, title: article.title, article_url: article.url, ai_description: article.summary})})' class="shr-icon btn-whatsapp" title="Share on WhatsApp">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      `;
    }

    // Format date as "Jan 16, 2025"
    function formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', {
        month: 'short',
        day: 'numeric',
        year: 'numeric'
      });
    }

    // Compact card date format: "25 Feb 26"
    function formatCardDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      if (isNaN(date.getTime())) return '';
      const day = date.getDate();
      const month = date.toLocaleDateString('en-GB', { month: 'short' });
      const year = String(date.getFullYear()).slice(-2);
      return `${day} ${month} ${year}`;
    }

    // ========== SHARE FUNCTIONS ==========

    function buildShareUrl(baseUrl, cardId, platform) {
      const url = new URL(baseUrl);
      url.searchParams.set('utm_source', 'smartpmo');
      url.searchParams.set('utm_medium', platform);
      url.searchParams.set('utm_campaign', 'share');
      url.searchParams.set('utm_content', cardId);
      return url.toString();
    }

    function trackShare(platform, cardId) {
      if (window.gtag) {
        gtag('event', 'share', {
          'event_category': 'engagement',
          'event_label': platform,
          'value': cardId
        });
      }

      fetch('/api/track-share', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          card_id: cardId,
          platform: platform,
          timestamp: new Date().toISOString()
        })
      }).catch(console.error);
    }

    function shareToLinkedIn(card) {
      const shareUrl = buildShareUrl(card.article_url || card.url, card.id, 'linkedin');
      const linkedInUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
      window.open(linkedInUrl, 'LinkedIn', 'width=600,height=600');
      trackShare('linkedin', card.id);
    }

    function shareToTwitter(card) {
      const maxTitleLength = 200;
      const title = card.title.length > maxTitleLength
        ? card.title.substring(0, maxTitleLength) + '...'
        : card.title;

      const shareUrl = buildShareUrl(card.article_url || card.url, card.id, 'twitter');
      const text = `${title} via @SmartPMO_AI`;
      const hashtags = 'PMO,AI,ProjectManagement';

      const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(shareUrl)}&hashtags=${hashtags}`;

      window.open(twitterUrl, 'Twitter', 'width=600,height=600');
      trackShare('twitter', card.id);
    }

    function shareViaEmail(card) {
      const subject = `PMO/AI Article: ${card.title}`;
      const shareUrl = buildShareUrl(card.article_url || card.url, card.id, 'email');

      const body = `I found this article on SmartPMO.ai:

${card.title}

${card.ai_description || card.summary || ''}

Read more: ${shareUrl}

--
Discovered via SmartPMO.ai - AI-powered content discovery for PMO professionals
https://smartpmo.ai`;

      const mailtoUrl = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      window.location.href = mailtoUrl;
      trackShare('email', card.id);
    }

    async function copyLink(card, event) {
      const shareUrl = buildShareUrl(card.article_url || card.url, card.id, 'copylink');

      try {
        await navigator.clipboard.writeText(shareUrl);

        const btn = event.currentTarget;
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<svg class="icon-check" width="16" height="16" viewBox="0 0 24 24"><path d="M5 12l-3-3 1-1 2 2 5-5 1 1z" fill="currentColor"/></svg> Copied!';
        btn.classList.add('success');

        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.classList.remove('success');
        }, 2000);

        trackShare('copylink', card.id);
      } catch (error) {
        const textArea = document.createElement('textarea');
        textArea.value = shareUrl;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        alert('Link copied!');
        trackShare('copylink', card.id);
      }
    }

    function shareToWhatsApp(card) {
      const shareUrl = buildShareUrl(card.article_url || card.url, card.id, 'whatsapp');
      const text = `${card.title}

${card.ai_description || card.summary || ''}

Read more: ${shareUrl}

via SmartPMO.ai`;

      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      const whatsappUrl = isMobile
        ? `whatsapp://send?text=${encodeURIComponent(text)}`
        : `https://wa.me/?text=${encodeURIComponent(text)}`;

      window.open(whatsappUrl, '_blank');
      trackShare('whatsapp', card.id);
    }

    // ========== END SHARE FUNCTIONS ==========

    loadDailyCards(); // Latest Intelligence with enriched cards (rich data from daily-cards.json)
    loadCuratedInsights(); // Strategic Insights (curated articles from displayed-articles.json)

  </script>

  <!-- VotesModule — B-04 Voting Buttons (SPEC-B04-VOTING-BUTTONS.md) -->
  <!-- CONTRACT §3.1: IIFE module pattern, no global leakage -->
  <script>
  const VotesModule = (() => {
    'use strict';

    // ── Config ──────────────────────────────────────────────────────────────
    // Production URL will differ — update this constant when deploying the API publicly.
    const API_BASE = 'https://smartpmo-votes.ggpera.workers.dev';
    const CARD_CONTAINER_ID = 'auto-articles-grid';

    // ── Helpers ──────────────────────────────────────────────────────────────
    function getVoteBars() {
      return Array.from(document.querySelectorAll('.card-footer-a[data-article-id]'));
    }

    // F-3B: No is-disabled — both buttons always clickable; aria-pressed marks current vote
    function applyVoteState(voteBar, userVote, upvotes, downvotes) {
      const upBtn     = voteBar.querySelector('.vote-btn--up');
      const downBtn   = voteBar.querySelector('.vote-btn--down');
      const upCount   = voteBar.querySelector('.vote-count--up');
      const downCount = voteBar.querySelector('.vote-count--down');

      if (upCount)   upCount.textContent   = upvotes;
      if (downCount) downCount.textContent = downvotes;

      if (userVote) {
        const pressedBtn = userVote === 'up' ? upBtn   : downBtn;
        const otherBtn   = userVote === 'up' ? downBtn : upBtn;
        if (pressedBtn) pressedBtn.setAttribute('aria-pressed', 'true');
        // F-3B: other button stays enabled — user can switch vote
        if (otherBtn)   { otherBtn.setAttribute('aria-pressed', 'false'); otherBtn.classList.remove('is-disabled'); }
      } else {
        if (upBtn)   { upBtn.setAttribute('aria-pressed', 'false');   upBtn.classList.remove('is-disabled');   }
        if (downBtn) { downBtn.setAttribute('aria-pressed', 'false'); downBtn.classList.remove('is-disabled'); }
      }
    }

    function hideVoteBar(voteBar) {
      // Hide the left group (votes + divider + date) — keep footer-right (share buttons) visible
      const leftEl = voteBar.querySelector('.footer-left');
      if (leftEl) { leftEl.style.display = 'none'; return; }
      // Fallback for curated cards (old structure): hide footer-votes + divider
      const votesEl = voteBar.querySelector('.footer-votes');
      const dividerEl = voteBar.querySelector('.footer-divider');
      if (votesEl) votesEl.style.display = 'none';
      if (dividerEl) dividerEl.style.display = 'none';
    }

    // ── F-1: Health-check-first approach ─────────────────────────────────────
    async function loadAllVotes() {
      const bars = getVoteBars();
      if (!bars.length) return;

      // Step 1: probe /health with a short timeout
      try {
        const healthRes = await fetch(`${API_BASE}/health`, { signal: AbortSignal.timeout(2000) });
        if (!healthRes.ok) throw new Error(`HTTP ${healthRes.status}`);
      } catch (err) {
        // API unreachable — hide ALL bars uniformly
        console.warn('[VotesModule] API unreachable, hiding all vote bars:', err.message);
        bars.forEach(hideVoteBar);
        return;
      }

      // Step 2: API is up — load each article's votes
      for (const bar of bars) {
        const articleId = bar.dataset.articleId;
        if (!articleId) continue;
        try {
          const res  = await fetch(`${API_BASE}/votes/${articleId}`, { signal: AbortSignal.timeout(4000) });
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          const data = await res.json();
          applyVoteState(bar, data.userVote, data.upvotes, data.downvotes);
        } catch (err) {
          // Individual failure — leave bar visible at 0/0, do not break loop
          console.warn(`[VotesModule] Could not load votes for article ${articleId}:`, err.message);
        }
      }
    }

    // ── Handle vote click ─────────────────────────────────────────────────────
    async function handleVoteClick(voteBar, clickedBtn) {
      const articleId = voteBar.dataset.articleId;
      const vote      = clickedBtn.classList.contains('vote-btn--up') ? 'up' : 'down';

      const upBtn     = voteBar.querySelector('.vote-btn--up');
      const downBtn   = voteBar.querySelector('.vote-btn--down');
      const upCount   = voteBar.querySelector('.vote-count--up');
      const downCount = voteBar.querySelector('.vote-count--down');

      // Capture previous state for rollback
      const prevUpPressed   = upBtn?.getAttribute('aria-pressed') === 'true';
      const prevDownPressed = downBtn?.getAttribute('aria-pressed') === 'true';
      const prevUpCount     = parseInt(upCount?.textContent || '0', 10);
      const prevDownCount   = parseInt(downCount?.textContent || '0', 10);

      // F-3B: Optimistic update — account for vote switching
      // If user previously voted the OTHER direction, subtract that count too
      let newUpCount   = prevUpCount;
      let newDownCount = prevDownCount;

      if (vote === 'up') {
        newUpCount += 1;
        if (prevDownPressed) newDownCount = Math.max(0, newDownCount - 1); // switching from down
      } else {
        newDownCount += 1;
        if (prevUpPressed) newUpCount = Math.max(0, newUpCount - 1); // switching from up
      }

      upBtn?.setAttribute('aria-pressed', vote === 'up' ? 'true' : 'false');
      downBtn?.setAttribute('aria-pressed', vote === 'down' ? 'true' : 'false');
      if (upCount)   upCount.textContent   = newUpCount;
      if (downCount) downCount.textContent = newDownCount;

      try {
        const res  = await fetch(`${API_BASE}/vote`, {
          method:  'POST',
          headers: { 'Content-Type': 'application/json' },
          body:    JSON.stringify({ article_id: parseInt(articleId, 10), vote }),
          signal:  AbortSignal.timeout(6000)
        });
        const data = await res.json();

        if (res.status === 200 || res.status === 409) {
          // Confirm with server-authoritative counts
          applyVoteState(voteBar, data.userVote, data.upvotes, data.downvotes);
        } else {
          console.error('[VotesModule] Unexpected response:', res.status, data);
          applyVoteState(voteBar, prevUpPressed ? 'up' : prevDownPressed ? 'down' : null, prevUpCount, prevDownCount);
        }
      } catch (err) {
        console.error('[VotesModule] Vote failed:', err.message);
        applyVoteState(voteBar, prevUpPressed ? 'up' : prevDownPressed ? 'down' : null, prevUpCount, prevDownCount);
      }
    }

    // ── Event delegation — attach once to each card grid ─────────────────────
    function attachDelegation(container) {
      container.addEventListener('click', (e) => {
        const btn = e.target.closest('.vote-btn');
        if (!btn) return;
        // F-3B: removed is-disabled guard — buttons always clickable
        if (btn.getAttribute('aria-pressed') === 'true') return; // no-op: clicking own current vote

        const voteBar = btn.closest('.card-footer-a');
        if (!voteBar) return;

        handleVoteClick(voteBar, btn);
      });
    }

    // ── Public API ────────────────────────────────────────────────────────────
    function init() {
      // Attach delegation to main card grid (and curated grid if present)
      const grids = ['auto-articles-grid', 'curated-articles-grid']
        .map(id => document.getElementById(id))
        .filter(Boolean);

      grids.forEach(attachDelegation);

      // Wait for cards to render before loading vote counts
      // Cards are rendered async — use MutationObserver to detect first render
      const mainGrid = document.getElementById(CARD_CONTAINER_ID);
      if (!mainGrid) return;

      const observer = new MutationObserver((mutations, obs) => {
        const bars = mainGrid.querySelectorAll('.card-footer-a[data-article-id]');
        if (bars.length > 0) {
          obs.disconnect();
          loadAllVotes();
        }
      });
      observer.observe(mainGrid, { childList: true, subtree: false });

      // Also try immediately (if cards already rendered by the time init runs)
      if (mainGrid.querySelectorAll('.card-footer-a[data-article-id]').length > 0) {
        observer.disconnect();
        loadAllVotes();
      }
    }

    function destroy() {
      // No persistent listeners to remove (delegation is on grid containers)
    }

    return { init, destroy };
  })();

  // Initialise when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => VotesModule.init());
  } else {
    VotesModule.init();
  }
  </script>

  <!-- PMO AI Assessment - Modular Hero -->
  <script src="hero-assessment.js"></script>

  <!-- Header Menu JavaScript -->
  <script>
  const HeaderMenu = (() => {
    return {
      toggle: function() {
        const menu = document.getElementById('siteHeaderMobileMenu');
        menu.classList.toggle('active');
      },
      close: function() {
        const menu = document.getElementById('siteHeaderMobileMenu');
        menu.classList.remove('active');
      }
    };
  })();

  // Close on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') HeaderMenu.close();
  });

  // Close on resize to desktop
  window.addEventListener('resize', () => {
    if (window.innerWidth > 768) HeaderMenu.close();
  });
  </script>

</body>
</html>














